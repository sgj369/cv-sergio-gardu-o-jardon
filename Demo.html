<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Copiar</title>
    <style>
        /* Estilos MUY básicos solo para ver el botón */
        body { font-family: sans-serif; padding: 20px; background-color: #f0f0f0; }
        #carta-text-content { background-color: #fff; padding: 15px; border-radius: 8px; margin-bottom: 15px; }
        #copy-carta-btn-bottom {
            background-color: #fff;
            border: 1px solid #ccc;
            color: #333;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1em;
            transition: all 0.2s ease;
        }
        #copy-carta-btn-bottom:hover { background-color: #e0e0e0; }
        #copy-carta-btn-bottom.copied { border-color: green; background-color: lightgreen; color: black; }
        .fa-copy, .fa-check { margin-right: 6px; } /* Simula espacio del icono */
    </style>
</head>
<body>

<h1>Carta de Presentación (Texto de Prueba)</h1>

<div id="carta-text-content">
    <p>
      Sergio Garduño Jardón es Ingeniero Mecatrónico por el IPN de UPIITA convencido de que la tecnología y la naturaleza pueden y deben coexistir. Su pasión por la vida y el medio ambiente lo impulsa a buscar formas innovadoras de utilizar el conocimiento para auxiliar a nuestro planeta, especializándose en el desarrollo de sistemas <strong>IoT para el monitoreo ecológico</strong>.
    </p>
    <p>
      Sergio diseña y desarrolla sistemas que nos permiten 'escuchar' las necesidades del entorno. Un claro ejemplo es su proyecto de tesis sobre <strong>techos verdes</strong>, donde implementó un sistema de monitoreo autónomo completo —desde el hardware con ESP32 y sensores, hasta el análisis de datos— demostrando cómo la tecnología puede validar y potenciar soluciones sostenibles. Su objetivo es seguir aplicando la mecatrónica, la programación y los datos en proyectos que generen un impacto ambiental positivo.
    </p>
    <p>
      Más allá de lo técnico, le apasiona conocer mas sobre flora y fauna, además de conectar con actores por medio del proyecto <strong>ECOGAIASOS</strong> que generan acciones en pro del planeta y participar activamente en eventos de limpieza o restauración de hábitats. Sergio cree firmemente que la acción combinada con el conocimiento adecuado siempre tendrá un mejor resultado.
    </p>
</div>

<button id="copy-carta-btn-bottom">
    <span class="fa-copy"></span> <span>Copiar Texto</span>
</button>

<script>
    // --- INICIALIZACIÓN CUANDO EL DOM ESTÁ LISTO ---
    document.addEventListener('DOMContentLoaded', () => {

        // --- Funcionalidad Copiar Carta ---
        const copyBtnBottom = document.getElementById('copy-carta-btn-bottom');
        const textToCopyContainer = document.getElementById('carta-text-content');

        console.log("Botón encontrado:", copyBtnBottom); // Verifica si encuentra el botón
        console.log("Contenedor de texto encontrado:", textToCopyContainer); // Verifica si encuentra el div

        if (copyBtnBottom && textToCopyContainer) {
            console.log("Añadiendo listener al botón..."); // Confirma que añade el listener
            copyBtnBottom.addEventListener('click', () => {
                console.log("¡Botón clickeado!"); // Verifica si el clic se registra

                const paragraphs = textToCopyContainer.querySelectorAll('p');
                let fullText = '';
                paragraphs.forEach((p, index) => {
                    let cleanText = p.textContent || p.innerText || '';
                    fullText += cleanText.trim();
                    if (index < paragraphs.length - 1) {
                      fullText += '\n\n';
                    }
                });

                console.log("Texto a copiar:", fullText); // Muestra el texto que intenta copiar

                if (navigator.clipboard && navigator.clipboard.writeText) {
                    navigator.clipboard.writeText(fullText).then(() => {
                        console.log("Copiado con éxito (API)"); // Confirma copia
                        const iconSpan = copyBtnBottom.querySelector('.fa-copy, .fa-check'); // Busca el span del icono
                        const textSpan = copyBtnBottom.querySelector('span:last-child'); // Busca el span del texto
                        const originalIconClass = 'fa-copy';
                        const originalText = 'Copiar Texto'; // Texto fijo para la prueba

                        if(iconSpan) iconSpan.className = 'fa-check'; // Cambia clase (simula icono)
                        if(textSpan) textSpan.textContent = '¡Copiado!';
                        copyBtnBottom.classList.add('copied');

                        setTimeout(() => {
                           if(iconSpan) iconSpan.className = originalIconClass; // Restaura clase
                           if(textSpan) textSpan.textContent = originalText; // Restaura texto
                           copyBtnBottom.classList.remove('copied');
                           console.log("Estado restaurado");
                        }, 1500);

                    }).catch(err => {
                        console.error('Error al copiar texto con API: ', err);
                        alert('No se pudo copiar el texto.');
                    });
                } else {
                     console.warn("API del portapapeles no disponible, intentando fallback...");
                    try {
                        const textArea = document.createElement('textarea');
                        textArea.value = fullText;
                        textArea.style.position = 'fixed'; // Evita scroll disruptivo
                        textArea.style.opacity = '0';
                        document.body.appendChild(textArea);
                        textArea.select();
                        document.execCommand('copy');
                        document.body.removeChild(textArea);
                        console.log("Copiado con éxito (Fallback)");
                        alert('Texto copiado (alternativo).');
                        // (Aquí también podrías añadir cambio visual temporal)
                    } catch (err) {
                        console.error('Error al copiar texto con fallback: ', err);
                        alert('No se pudo copiar el texto.');
                    }
                }
            });
        } else {
            console.error("No se encontró el botón o el contenedor de texto.");
        }
    }); // --- FIN DEL DOMContentLoaded ---
</script>

</body>
</html>
